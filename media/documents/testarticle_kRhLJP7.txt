AN ANALOGUE OF THE STRENGTHENED HANNA NEUMANN CONJECTURE FOR VIRTUALLY FREE GROUPS
AND VIRTUALLY FREE PRODUCTS
Anton A. Klyachko
♭ Alexander O. Zakharov
♯
♭Faculty of Mechanics and Mathematics of Moscow State University
Moscow 119991, Leninskie gory, MSU.
Moscow Center for Fundamental and Applied mathematics.
klyachko@mech.math.msu.su
♯Mathematical Institute of the University of Wroc law, pl. Grunwaldzki 2/4, 50-384, Wroc law.
zakhar.sasha@gmail.com
The Friedman–Mineyev theorem, earlier known as the (strengthened) Hanna Neumann conjecture, gives a sharp estimate fo
r
the rank of the intersection of two subgroups in a free group. We obtain an analogue of this inequality for any two subgroups in a
virtually free group (or, more generally, in a group containing a free product of left-orderable groups as a finite-index subgroup).
0. Introduction
The Hanna Neumann Conjecture (1957), proved independently by Mineyev and Friedman is the following fact.
Friedman–Mineyev theorem[Mi12a], [Mi12b], [Fr14]
. For any nontrivial subgroups
A and
B of a free group
F
,
rank(
A
∩
B
)
−
1
6 (rank(
A
)
− 1)
· (rank(
B
)
− 1); (the classical Hanna Neumann conjecture
)
moreover, for any system of representatives
S of the double cosets AsB in
F
,
Xs∈S
rank(
A
∩ sBs
−
1
)
6 rank(
A
)
· rank(
B
)
,
(the strengthened Hanna Neumann conjecture
)
where rank(
H
)
def = max(0
, rank(
H
)
− 1) is the reduced rank of a free group
H
.
Alternative proofs and generalisations of this result can be found, e.g., in [D12], [AMS14], [Za14], [ASS15], [Nos16],
[HW16], [Iv17], [JZ17] and [KP20]. In particular, the following analogue of the classical Hanna Neumann conjecture
for free subgroups of a virtually free group was obtained in [KP20]:
for any free subgroups
A and
B of a virtually free group
G containing a free finite-index subgroup
F
rank(
A
∩
B
)
6 |G
:
F| · rank(
A
)
· rank(
B
)
.
This estimate strengthens earlier known inequalities [Za14], [ASS15] (and is already sharp). We generalise this fact in
two directions:
- first, we obtain an analogue of the s t r e n g t h e n e d Hanna Neumann conjecture;
- and secondly, our estimate applies to a r b i t r a r y subgroups
A and
B of a virtually free group.
Theorem on intersection of subgroups in virtually free groups. For any subgroups
A and
B of a virtually free
group
G containing a free group
F as a finite-index subgroup and for any system of representatives
S of the double
cosets AsB in
G
,
Xs∈S
rk(
A
∩ sBs
−
1
)
6 |G
:
F| · rk(
A
)
· rk(
B
)
. In particular, rk(
A
∩
B
)
6 |G
:
F| · rk(
A
)
· rk(
B
)
.
Here rk(
H) is the virtual reduced rank of a virtually free group: rk(
H
)
def =
1 |H:
K| · max

0
,rank(
K
)
−
1

, where
K is
a finite-index free subgroup of
H. It is easy to show that the virtual reduced rank is well-defined (i.e. it does not
depend on the choice of a free subgroup
K); and rk(
H) = rank(
H), if
H is free. Note that the virtual reduced rank of
a virtually free group coincides with the rank gradient of this group [La05].
Actually, the theorem above is a special case of a more general main theorem of this paper (see the next section),
which is about intersections of subgroups in virtually free products. In particular, our main theorem generalises the
following known analogue of the strengthened Hanna Neumann conjecture.
The work of the first author was supported by the Russian Foundation for Basic Research, project no. 19-01-00591. 
Theorem AMS [AMS14] (see also [Iv17]). For any subgroups A and B of a free product G =
i
*
∈I
Gi of left-orderable
groups Gi and for any system of representatives S of double cosets AsB in G
X
s∈S
rankK(A ∩ sBs−1
) 6 rankK(A) · rankK(B). In particular, rankK(A ∩ B) 6 rankK(A) · rankK(B).
Here, rankK(H) is the reduced Kurosh rank of a subgroup H ⊆ G =
i
*
∈I
Gi
, which is defined as follows: the subgroup H
decomposes (by the Kurosh theorem) into a free product H =

j
*
∈J
Hj

∗ F, where each Hj is nontrivial and
conjugate to a subgroup of one of Gi
, and F is free and trivially intersects all conjugate to subgroups Gi
; then
rankK(H)
def = max(0, |J| + rank(F) − 1).
Our proof of the main theorem is based on Mineyev’s approach [Mi12b], but our definitions are somewhat different;
therefore, we prove everything “from the scratch”; thus, this paper contains yet another alternative (simpler) proof of
the Friedman–Mineyev theorem.
The main features of our argument are that, considering actions of groups on forests, we
- never refer explicitly to the quotient graph of this action
- and never require the cocompactness of the action.
This allows us to say that our main theorem and all its corollary stated above (including the Friedman–Mineyev
theorem) are essentially special cases of a quite elementary lemma on group actions (on sets), see Section 2.
1. Main theorem
If a group G contains a free product F =
i
*
∈I
Gi of infinite groups Gi as a finite-index subgroup, then, for any subgroup
H ⊆ G, the virtual reduced Kurosh rank rk(H) with respect to the family of subgroups Gi
is defined as
rk(H)
def =
rankK(K)
|H:K|
,
where K is a subgroup of finite index in H contained in F, and rankK(K) is the (usual) reduced Kurosh rank of
a subgroup K of F =
i
*
∈I
Gi
. This value is well-defined, i.e. it does not depend on the choice of K (because of an
analogue of the Schreier formula for the Kurosh rank [Ku83]), but is not conjugation-invariant, i.e. the numbers rk(H)
and rk(gHg−1
) may differ. To remedy this unpleasant feature, we define the total virtual reduced Kurosh rank r(H)
(with respect to the family {Gi
| i ∈ I}) as: r(H) = Pn
j=1
rk(gjHg−1
j
), where rk is the virtual reduced Kurosh rank with
respect to the given family of subgroups, and g1, . . . , gn are representatives the right cosets of F in G. It is easy to see
that this value is conjugation-invariant and does not depend on the choice of representatives gj .
Main theorem. Let a group G be a virtually free product of left-orderable groups, i.e. G contains a finite-index
subgroup F =
i
*
∈I
Gi
, where all groups Gi are left-orderable. Let A and B be subgroups of G, and let S be a set of
distinct representatives of double cosets AgB in G. Then P
s∈S
r(A ∩ sBs−1
) 6 r(A) · r(B), where r(H) is the total
virtual reduced Kurosh rank of H ⊆ G (with respect to the family {Gi
| i ∈ I}).
In particular, r(A ∩ B) 6 r(A) · r(B).
This generalises earlier known results:
- the case, where F = G, of our theorem is Theorem AMS [AMS14] (if, in addition, all Gi are infinite cyclic, then
we obtain the Friedman–Mineyev theorem (earlier known, as the strengthened Hanna Neumann conjecture);
- in the case, where A and B are free groups trivially intersecting subgroups conjugate to free factors Gi
, the
assertion “In particular” is the main result of [KP20].
To derive the theorem on intersections of subgroups in virtually free groups (see Introduction) from the main theorem,
it suffices to note that the virtual reduced rank rk(H) of a virtually free subgroup H ⊆ G coincides with the virtual
reduced Kurosh rank with respect to any family of infinite cyclic subgroups whose free product is F. Therefore, all terms
in the definition of the total virtual rank r(H) are equal (and their number is the index of F), i.e. r(H) = |G:F|·rk(H)
in this case.
2
2. Actions
Strange as it may seem, we have not succeeded to find the following simple lemma in the literature.
Orbit-intersection lemma. Let A and B be subgroups of a group G that acts freely on a set, and let D be a set of
distinct representatives of double cosets AgB. Then
X
d∈D
(the number of (Ad ∩ B)-orbits) 6 (the number of A-orbits) · (the number of B-orbits).
Moreover, for any A-invariant set Y ⊆ X and any B-invariant set Z ⊆ X,
X
d∈D

the number of (Ad ∩ B)-orbits in (d
−1 ◦ Y ) ∩ Z

6(the number of A-orbits in Y )·(the number of B-orbits in Z).
Proof. Suppose that G × X
◦ −→ X is a free action, and X/H is the set of orbits of the action of a subgroup H ⊆ G.
Consider the mapping
Φ: n
(d, U) | d ∈ D, U ∈

(d
−1
◦ Y ) ∩ Z

/(A
d ∩ B)
o
→ Y /A × Z/B,
d, (A
d ∩ B) ◦ x

7→ (A ◦ d ◦ x, B ◦ x).
The assertion of the lemma follows immediately from the following observations: this mapping is
- well-defined,
i.e., it does not depend on the choice of x in the (Ad ∩ B)-orbit (obviously),
- and injective;
indeed, (A◦d◦x, B◦x) = (A◦d
′ ◦x
′
, B◦x
′
) means that d
′ ◦x
′ ∈ A◦d◦x and x
′ ∈ B◦x, i.e. (d
′B)∩(Ad) 6= ∅
(because the action is free) and, means, d
′ = d (by the definition of D); so, x
′ ∈ (Ad ◦x)∩(B◦x) = (Ad∩B)◦x,
as required.
3. Actions on forests
All graphs in this paper are directed. Let a group G act on a forest Γ freely on edges (i.e. the stabiliser of each edge
is trivial). A set E of orbits of edges of Γ is called maximal essential if E is an inclusion maximal set such that each
component of the forest Γ \
S
E, which is not a component of Γ, has a nontrivial stabiliser. The following lemma is a
simple (and probably known) fact on groups acting on trees.
Kurosh-rank lemma. A group G acting on a tree Γ freely on edges decomposes into a free product: G = F∗

i
*
∈I
Gi

,
where F is a free group acting on Γ freely, and Gi 6= {1} are stabilisers of some vertices; if the Kurosh rank of this
decomposition is finite (i.e. rank(F)+|I| < ∞), then the cardinality of any maximal essential set E equals the reduced
Kurosh rank of this decomposition: |E| = max(0, rank(F) + |I| − 1).
Sketch of a proof. For any edge e consider the components X and Y of the forest Γ \ (G ◦ e) connected by e. The
ping-pong lemma implies immediately that
G =



St(X) ∗ hgi∞ , if g ◦ X = Y for some g ∈ G (which necessarily acts freely on Γ);
St(X) ∗ St(Y ), if g ◦ X 6= Y for any g ∈ G.
An obvious induction completes the proof.
We want to generalise this simple fact to the case, where Γ is a forest consisting of finitely many trees: Γ = T1⊔. . .⊔Tn.
In this case, the virtual reduced Kurosh rank of the (action of) the group G is naturally defined: choose in G a finiteindex subgroup H that stabilises a tree Tj and, therefore, decomposes into a free product H = F ∗

i
*
∈I
Gi

, where
F is a free group acting on Tj freely, and Gi 6= {1} are stabilisers of some vertices of Tj; the reduced Kurosh rank of
this subgroup (with respect to the given action on Tj ) is rk(H)
def = max(0, rankF + |I| − 1), and the virtual reduced
Kurosh rank of G (with respect to the given action on Γ and given component Tj of Γ) is naturally defined as:
rkj (G)
def =
1
|G:H|
·rk(H). It is easy to see that this value does not depend on the choice of the subgroup H (if nontrivial
vertex stabilisers are infinite), but can depend on j. We call the value P
j
rkj (G) the total virtual reduced Kurosh rank
of this action.

Virtual-Kurosh-rank lemma. Suppose that a group G acts freely on edges on a forest Γ = T1 ⊔ . . . ⊔Tn consisting
P
of trees Tj , The stabiliser of each Tj has finite Kurosh rank, and nontrivial vertex stabilisers are infinite. Then
rkj (G) = |E| for each maximal essential set E.
Proof. Suppose that Γ = Γ1 ⊔. . .⊔Γk and, on each G-invariant forest Γi
, the action of G is transitive on components
(i.e., for any components Tl
, Tm ⊆ Γi
, there exists g ∈ G such that g ◦ Tl = Tm). Then E = E1 ⊔ . . . ⊔ Ek, where
Ei = {G ◦ e ∈ E | G ◦ e ⊆ Γi} is a maximal essential set of orbits of edges of the forest Γi
. Therefore, it suffices to
prove assertion for the case, where the action of G on Γ is transitive on components of Γ.
In this case, all stabilisers Hj = St(Tj) of trees Tj are conjugate and, hence, isomorphic and act on its trees
similarly. In particular, rk(Hj ) does not depends on j. Moreover, |G:Hj | = n for all j (because the length of an orbit
equals the index of the stabiliser). Therefore,
Xn
j=1
rkj (G) = Xn
j=1
1
|G:Hj |
· rk(Hj ) = Xn
j=1
1
n
· rk(H1) = rk(H1).
On the other hand, the set of H1-orbits of edges E′ = {G ◦ e ∩ T1 | G ◦ e ∈ E} is, obviously, maximal essential with
respect to the action of H1 on T1. Therefore, |E| = |E′
| = rk(H1) (the latter equality follows from the Kurosh-rank
lemma). This completes proof.
4. Actions on ordered forests
We say that a graph is ordered if it is equipped with a partial order on the set of edges inducing a linear order on the
set of edges of each connected component.
Induced-action lemma [KP20]. If a group G has subgroup F finite index n, which acts on an ordered tree T
preserving the order. Then G can act preserving the order on an ordered forest consisting of n trees; the stabilisers of
vertices and edges of this action are conjugate to the stabilisers of vertices and edges for the initial action of F on T .
Proof. Let S ∋ 1 be a system of representatives of the left cosets of F in G (i.e. |S| = n). Thus, each element g ∈ G
decomposes uniquely into a product g = s(g)f(g) of an element s(g) ∈ S and an element f(g) ∈ F.
Take the ordered forest L =
S
s∈S
sT consisting of n copies sT of the ordered tree T (edges from different copies
are incomparable) and consider the usual induced action of G on L: g ◦ st def = s(gs)

f(gs) ◦ t

. Clearly, this action
satisfies all requirements. This completes the proof.
An edge e of an ordered forest with an order-reserving action of a group H is called important (or H-important)
if it is the maximal edge on an bi-infinite line T (e) intersecting only finitely many orbits of edges.
Important-edge lemma. If a group G acts on an ordered forest T preserving the order and freely on edges, then
- the set E of orbits of important edges contains a maximal essential set;
- each finite subset E
′ ⊆ E is contained in a maximal essential set.
In particular, the total virtual reduced Kurosh rank of this action
- equals |E| if |E| < ∞,
- is infinite if E is infinite.
Proof. The assertion “In particular” follows from the main assertion by the virtual-Kurosh-rank lemma. It remains
to prove the main assertion. Put E =
S
E and E
′ =
S
E
′
. We have to establish two facts:
1) the stabiliser St(K) of each component K of the forest T \ E has either a fixed point or an invariant line in K;
2) but the stabiliser of each component K of the forest T \ E′
is nontrivial, if there exists an important edge e ∈ E′
in T incident to a vertex of K.
The both facts are easy to prove.
1) If 1) does not hold, then the stabiliser of a component K of T \E contains a rank-two free subgroup F(x, y) ⊆ St(K)
acting freely on K (because each non-dihedral group nontrivially decomposable into a free product contains free
subgroup that trivially intersects the free factors; the group G cannot be dihedral, because G is torsion-free if T
has at least one edge). Let lx and ly be invariant lines in K for elements x and y, respectively. The intersection
of these lines is a finite graph: either an interval, a point, or the empty set (it cannot be a ray, as is known). Let
us connect the lines lx and ly by a path π. Let us choose finite intervals px and py such that lx =
S
k∈Z
x
k ◦ px
and ly =
S
k∈Z
y
k ◦ px; and let us take the maximal edges ex and ey on the intervals px and py. Without loss of
generality we assume that
- x ◦ ex < ex and y ◦ ey < ey (replace x with x
−1 and/or y on y
−1
, if this is not the case);
4
-

S∞
k=0
x
k ◦ px

∩ (ly ∪ π) = ∅ =

S∞
k=0
y
k ◦ py

∩ (lx ∪ π) (replace px with x
n ◦ px and/or py with y
n ◦ py for
sufficiently large n ∈ N, if this not the case).
Let us connect now px and py by a path p ⊃ (px ∪ py). The maximal edge e of p the maximal edge on the
line p ∪

S∞
k=0
x
k ◦ px

∪

S∞
k=0
y
k ◦ py

. Thus the edge e is important. This contradiction completes the proof
of 1).
2) Suppose that an important edge e ∈ E
′
ends at a vertex of K. If edge g ◦ e ends also at a vertex of K, then
g ∈ St(K) and, therefore, St(K) 6= {1} if g 6= 1. Hence, it suffices to consider the case, where there are only
finitely many (at most 2|E′
|) important edges from E′
incident to vertices of K. Let e ∈ E′ be the minimal edge
of E′
incident to a vertex of K. Then an infinite ray of T (e) (from the definition of the importance) must lie in K
(because of the minimality of e). Since this ray can intersect only finitely many orbits of edges (by the definition
of importance), we obtain an infinite set of edges of K lying in the same orbit. Thus, St(K) 6= {1} as required.
5. Proof of the main theorem
Put n = |G:F| and let T be the (Bass–Serre) tree for the decomposition F =
i
*
∈I
Gi
, i.e. F acts on T freely on edges
and in such a way that the stabiliser of each vertex is conjugate to one of the factors Gi
. The tree T can be ordered:
the order on the set of edges of T is induced by a left-invariant order on group F (which, as is known, exists [Vi49],
[DS14]). Thus, the action of ˇ F on T preserves the order and is free on edges. By the induced-action lemma, the group
G acts on an ordered forest Γ = T1 ⊔ . . . ⊔ Tn consisting of n trees Tj transitively on components, freely on edges,
and preserving the order. Moreover, St(T1) = F and Tj = gjT1, where g1 = 1, g2, . . . , gn are representatives of the left
cosets of F in G.
The groups A and B act on the forest Γ freely on edges and preserving the order. Then the sum over s ∈ S of the
number of (As ∩ B)-orbits of important edges under the action of As ∩ B on L is at most the product of the number
of A-orbits of important edges under the action of A on L and the number of B-orbits of important edges under the
action of B on L by the orbit-intersection lemma applied to
Y = {A-important edges of Γ} ⊆ X = {edges of Γ} ⊇ Z = {B-important edges of Γ}.
By the important-edge lemma, the set of orbits of important edges is maximal essential (if a maximal essential set
finite). Therefore, by the virtual-Kurosh-rank lemma
